<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>All in One - Navigation</title>
  <style>
    :root {
      --bg-color: #101012;
      --card-color: rgba(22, 22, 25, 0.6);
      --card-border: rgba(255, 255, 255, 0.1);
      --hover-color: rgba(35, 35, 40, 0.8);
      --text-primary: #f0f2f5;
      --text-secondary: #a0a2a5;
      --accent-color: #007aff;
      --shadow-color: rgba(0, 0, 0, 0.2);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
      padding: 2rem;
      background-image: radial-gradient(circle at 1% 1%, rgba(40, 90, 255, 0.15), transparent 30%),
      radial-gradient(circle at 99% 99%, rgba(255, 40, 90, 0.15), transparent 40%);
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    .layout {
      position: relative;
    }

    header {
      margin-bottom: 2.5rem;
      animation: fadeInDown 0.8s ease-out;
    }

    h1 {
      font-weight: 700;
      font-size: 2.2rem;
      letter-spacing: -0.5px;
      margin-bottom: 0.5rem;
    }

    .subtitle {
      color: var(--text-secondary);
      font-size: 1rem;
    }

    .main-area {
      max-width: 100%;
    }

    .side-panel {
      position: fixed;
      top: 1.5rem;
      right: 0;
      width: 110px;
      padding-right: calc(env(safe-area-inset-right, 0px));
      max-height: calc(100vh - 4rem);
      border-radius: 24px 0 0 24px;
      background: rgba(15, 15, 20, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.12);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.35);
      overflow: hidden;
      transition: width 0.35s ease, box-shadow 0.35s ease, backdrop-filter 0.35s ease;
      display: flex;
      flex-direction: column;
      z-index: 30;
      backdrop-filter: blur(10px);
    }

    .side-panel:hover,
    .side-panel:focus-within {
      width: 360px;
      right: 0;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.45);
      backdrop-filter: blur(18px);
    }

    .panel-hint {
      writing-mode: vertical-rl;
      text-orientation: mixed;
      text-transform: uppercase;
      letter-spacing: 4px;
      font-size: 0.75rem;
      color: var(--text-secondary);
      text-align: center;
      padding: 1rem 0;
      flex-shrink: 0;
      transition: opacity 0.2s ease, transform 0.2s ease;
    }

    .side-panel:hover .panel-hint,
    .side-panel:focus-within .panel-hint {
      opacity: 0;
      transform: translateX(20px);
      height: 0;
      margin: 0;
      padding: 0;
    }

    .panel-body {
      opacity: 0;
      pointer-events: none;
      padding: 0;
      overflow: hidden;
      flex: 0;
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      max-height: 0;
      transition: opacity 0.25s ease, padding 0.25s ease, max-height 0.25s ease;
    }

    .side-panel:hover .panel-body,
    .side-panel:focus-within .panel-body {
      opacity: 1;
      pointer-events: auto;
      padding: 1.2rem;
      flex: 1;
      overflow-y: auto;
      max-height: calc(100vh - 4rem);
    }

    .hero-card {
      background: linear-gradient(135deg, rgba(0, 122, 255, 0.2), rgba(138, 43, 226, 0.15));
      border-radius: 20px;
      padding: 1.5rem;
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.35);
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
    }

    .hero-greeting {
      font-size: 1.6rem;
      font-weight: 600;
    }

    .hero-tip {
      color: var(--text-secondary);
      font-size: 0.95rem;
    }

    .hero-quick {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      align-items: center;
      font-size: 0.9rem;
    }

    .hero-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
    }

    .hero-tag {
      background: rgba(16, 16, 18, 0.25);
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 0.2rem 0.7rem;
      border-radius: 999px;
      font-size: 0.85rem;
      color: var(--text-primary);
    }

    .info-panel {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .domain-summary {
      color: var(--text-secondary);
      font-size: 0.9rem;
    }

    .tags-panel {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      background: rgba(20, 20, 24, 0.4);
      border: 1px dashed var(--card-border);
      border-radius: 16px;
      padding: 1rem;
    }

    .recent-panel {
      background: rgba(15, 15, 20, 0.45);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 16px;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
    }

    .recent-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 0.95rem;
      color: var(--text-secondary);
    }

    .recent-clear {
      background: none;
      border: none;
      color: var(--accent-color);
      font-size: 0.85rem;
      cursor: pointer;
    }

    .recent-list {
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
    }

    .recent-item {
      padding: 0.6rem 0.8rem;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.05);
      display: flex;
      flex-direction: column;
      gap: 0.15rem;
    }

    .recent-title {
      font-size: 0.95rem;
      color: var(--text-primary);
    }

    .recent-meta {
      font-size: 0.8rem;
      color: var(--text-secondary);
    }

    .recent-empty {
      color: var(--text-secondary);
      font-size: 0.9rem;
    }

    .tags-label {
      font-size: 0.9rem;
      color: var(--text-secondary);
    }

    .tags-scroll {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .tag-chip {
      border: 1px solid rgba(255, 255, 255, 0.15);
      color: var(--text-secondary);
      font-size: 0.85rem;
      border-radius: 999px;
      padding: 0.35rem 0.85rem;
      background: transparent;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .tag-chip.active {
      background: rgba(0, 122, 255, 0.15);
      color: var(--accent-color);
      border-color: var(--accent-color);
    }

    .tag-chip:focus-visible {
      outline: 2px solid var(--accent-color);
      outline-offset: 2px;
    }

    .categories {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
      gap: 1.5rem;
    }

    .category {
      background: var(--card-color);
      border-radius: 18px;
      border: 1px solid var(--card-border);
      box-shadow: 0 8px 32px var(--shadow-color);
      backdrop-filter: blur(20px);
      transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      animation: fadeInUp 0.6s ease-out;
    }

    .category.hidden {
      display: none;
    }

    .category:hover {
      transform: translateY(-5px) scale(1.02);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
      border-color: rgba(255, 255, 255, 0.2);
    }

    .category-header {
      padding: 1.25rem 1.5rem;
      border-bottom: 1px solid var(--card-border);
      display: flex;
      align-items: center;
      gap: 0.75rem;
      justify-content: space-between;
    }

    .category-toggle {
      background: none;
      border: 1px solid rgba(255, 255, 255, 0.15);
      color: var(--text-secondary);
      border-radius: 999px;
      padding: 0.25rem 0.8rem;
      font-size: 0.85rem;
      cursor: pointer;
    }

    .category-title {
      font-size: 1.2rem;
      font-weight: 600;
    }

    .links {
      padding: 0.75rem;
      overflow-y: auto;
      overflow-x: hidden;
      flex-grow: 1;
    }

    .category.collapsed .links {
      display: none;
    }

    .category.collapsed .category-toggle {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text-primary);
    }

    .link-item {
      display: flex;
      align-items: center;
      padding: 1rem 1.25rem;
      border-radius: 12px;
      margin-bottom: 0.5rem;
      cursor: pointer;
      transition: all 0.25s ease;
      position: relative;
    }

    .link-item.hidden {
      display: none;
    }

    .link-item:last-child {
      margin-bottom: 0;
    }

    .link-item:hover {
      background: var(--hover-color);
      transform: scale(1.03);
    }

    .category-count {
      font-size: 0.9rem;
      color: var(--text-secondary);
    }

    .link-icon {
      margin-right: 1rem;
      width: 24px;
      height: 24px;
      color: var(--text-secondary);
      flex-shrink: 0;
    }

    .link-content {
      flex-grow: 1;
      overflow: hidden;
    }

    .link-title {
      font-weight: 500;
      font-size: 1rem;
      margin-bottom: 0.2rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      color: var(--text-primary);
    }

    .link-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.3rem;
      margin-top: 0.35rem;
    }

    .link-tag {
      font-size: 0.75rem;
      color: var(--accent-color);
      background: rgba(0, 122, 255, 0.12);
      padding: 0.2rem 0.5rem;
      border-radius: 999px;
    }

    .link-url {
      color: var(--text-secondary);
      font-size: 0.85rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .link-item:hover .link-url {
      color: var(--accent-color);
    }

    .tooltip {
      position: absolute;
      bottom: calc(100% + 10px);
      left: 50%;
      transform: translateX(-50%);
      background: rgba(30, 30, 32, 0.9);
      backdrop-filter: blur(10px);
      color: var(--text-primary);
      padding: 0.6rem 1rem;
      border-radius: 8px;
      font-size: 0.85rem;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      opacity: 0;
      transition: all 0.3s ease;
      pointer-events: none;
      z-index: 10;
      white-space: nowrap;
      border: 1px solid var(--card-border);
    }

    .link-item:hover .tooltip {
      opacity: 1;
      transform: translateX(-50%) translateY(-5px);
    }

    .empty-state {
      text-align: center;
      padding: 3rem 1rem;
      color: var(--text-secondary);
      border: 1px dashed var(--card-border);
      border-radius: 18px;
      background: rgba(20, 20, 24, 0.35);
    }

    .mini-tip {
      margin-top: 0;
      margin-bottom: 0;
      padding: 0.85rem 1.1rem;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.08);
      color: var(--text-secondary);
      font-size: 0.85rem;
    }

    .side-panel .mini-tip {
      margin-top: 0.5rem;
    }

    .toast {
      position: fixed;
      bottom: 2rem;
      left: 2rem;
      background: rgba(16, 16, 20, 0.9);
      border: 1px solid rgba(255, 255, 255, 0.15);
      color: var(--text-primary);
      padding: 0.8rem 1.2rem;
      border-radius: 999px;
      opacity: 0;
      pointer-events: none;
      transform: translateY(20px);
      transition: opacity 0.2s ease, transform 0.2s ease;
      z-index: 50;
    }

    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }

    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @media (max-width: 1100px) {
      .main-area {
        margin-right: 0;
      }

      .side-panel {
        position: static;
        width: 100%;
        max-height: none;
        margin-top: 0.5rem;
      }

      .side-panel,
      .side-panel:hover,
      .side-panel:focus-within {
        width: 100%;
      }

      .panel-hint {
        display: none;
      }

      .panel-body {
        opacity: 1;
        pointer-events: auto;
      }
    }

    @media (max-width: 768px) {
      body {
        padding: 1rem;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }

      .tags-scroll {
        justify-content: flex-start;
      }

      .toast {
        left: 1rem;
        right: 1rem;
        text-align: center;
      }

      h1 {
        font-size: 1.8rem;
      }

      .categories {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
<div class="layout">
  <main class="main-area">
    <div class="container">
      <header>
        <h1>All in One</h1>
        <p class="subtitle">NCIS å›¢é˜Ÿé«˜é¢‘èµ„æºå¯¼èˆªé¢æ¿</p>
      </header>

      <div class="categories"></div>
    </div>
  </main>

  <aside class="side-panel" data-side-panel>
    <div class="panel-hint">å¯¼èˆªåŠ©ç†</div>
    <div class="panel-body">
      <section class="info-panel">
        <div class="hero-card" data-hero>
          <div class="hero-greeting" data-greeting>æ¬¢è¿å›æ¥ ğŸ‘‹</div>
          <p class="hero-tip" data-hero-tip>ä»Šæ—¥æš‚æ— æé†’ï¼Œä¿æŒå¥½çŠ¶æ€ç»§ç»­æ¨è¿›é¡¹ç›®å§ã€‚</p>
          <div class="hero-quick">
            <span>ä»Šæ—¥çƒ­è¯ï¼š</span>
            <div class="hero-tags" data-hot-tags></div>
          </div>
        </div>

        <div class="recent-panel">
          <div class="recent-header">
            <span>æœ€è¿‘è®¿é—®</span>
            <button class="recent-clear" data-clear-history>æ¸…é™¤</button>
          </div>
          <div class="recent-list" data-recent-list>
            <div class="recent-empty">è¿˜æ²¡æœ‰è®¿é—®è®°å½•ï¼Œç‚¹å‡»ä»»æ„é“¾æ¥å³å¯è®°å½•ã€‚</div>
          </div>
        </div>
        <div class="domain-summary" data-stat="domains">é£ä¹¦ 0 / å†…ç½‘ 0 / å¤–éƒ¨ 0</div>
        <div class="tags-panel">
          <div class="tags-label" data-active-tag>å¿«é€Ÿæ ‡ç­¾ï¼ˆç‚¹å‡»ç­›é€‰ï¼‰</div>
          <div class="tags-scroll" data-tags-container></div>
        </div>
        <div class="mini-tip" data-mini-tip>å°æç¤ºï¼šåˆç†å®‰æ’æ·±å¤œè®¿é—®ï¼Œæ³¨æ„ VPN ä¸ç½‘ç»œç¯å¢ƒåˆ‡æ¢ã€‚</div>
      </section>
    </div>
  </aside>
</div>

<div class="toast" data-toast>å·²æ‰“å¼€é“¾æ¥</div>

<script>
  // ===================================================================================
  // ===== æœªæ¥ä½ åªéœ€è¦ç»´æŠ¤ä¸‹é¢çš„ navigationData åˆ—è¡¨å³å¯ =====
  // ===================================================================================
  const RECENT_LINKS_KEY = 'navhub_recent_links';
  const MAX_RECENT_LINKS = 5;

  const navigationData = [
    {
      title: "é¡¹ç›®ç®¡ç†",
      links: [
        {
          title: "NCIS ç¦…é“ä»»åŠ¡æ€»è§ˆ",
          url: "http://pm.saiit.com.cn/my/",
          description: "ç¦…é“ä»»åŠ¡æ€»è§ˆåŠå¾…åŠé¢æ¿",
          tags: ["NCIS", "ç¦…é“", "ç®¡ç†"],
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>`
        },
        {
          title: "éœ€æ±‚è§„æ ¼ 2.0",
          url: "https://fyvnc1t6bo.feishu.cn/wiki/JWOGw4HU5iiqQJktPcbceGOzndg?fromScene=spaceOverview",
          description: "æ–°ç‰ˆæœ¬éœ€æ±‚è§„æ ¼è¯´æ˜",
          tags: ["é£ä¹¦", "éœ€æ±‚", "æ–‡æ¡£"],
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>`
        },
        {
          title: "NCIS åŸå‹",
          url: "https://modao.cc/proto/FIFBDXrsv9h48aYqq8cpA/sharing?view_mode=device&screen=rbpUn2ZfEb5wxQ4Eo&canvasId=rcUjMnlRUn34N1M9YK5pEU",
          description: "NCIS ç³»ç»Ÿäº§å“åŸå‹",
          tags: ["NCIS", "åŸå‹", "è®¾è®¡"],
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect><line x1="12" y1="18" x2="12.01" y2="18"></line></svg>`
        },
        {
          title: "NCIS æ•°æ¨¡",
          url: "https://www.pdmaas.cn/design?projectId=1951183560404127746",
          description: "æ•°æ®åº“è®¾è®¡æ–‡æ¡£",
          tags: ["NCIS", "æ•°æ®åº“", "è®¾è®¡"],
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>`
        },
        {
          title: "é‡è¦æ•°æ®è„šæœ¬åŒæ­¥åˆ°UAT",
          url: "https://fyvnc1t6bo.feishu.cn/wiki/C8pTwMfFviw7Nhk9MSVcvCe0noe?sheet=VByGeN",
          description: "UAT ç¯å¢ƒå…³é”®æ•°æ®è„šæœ¬",
          tags: ["é£ä¹¦", "æ•°æ®åº“", "UAT"],
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>`
        },
      ]
    },

    {
      title: "å¼€å‘",
      links: [
        {
          title: "NCIS å¼€å‘ç¯å¢ƒ",
          url: "https://ncis-dev.szgas.com.cn/system/user",
          description: "NCIS å¼€å‘ç¯å¢ƒåœ¨çº¿",
          tags: ["NCIS", "ç¯å¢ƒ", "å†…ç½‘"],
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>`
        },
        {
          title: "NCIS æ•°æ®åº“è„šæœ¬",
          url: "https://fyvnc1t6bo.feishu.cn/wiki/C8pTwMfFviw7Nhk9MSVcvCe0noe?sheet=VByGeN",
          description: "NCIS æ•°æ®åº“è„šæœ¬",
          tags: ["é£ä¹¦", "æ•°æ®åº“", "NCIS"],
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect><line x1="12" y1="18" x2="12.01" y2="18"></line></svg>`
        },
        {
          title: "NCIS åç«¯å¼€å‘è§„èŒƒ",
          url: "https://fyvnc1t6bo.feishu.cn/wiki/JwcDwpXwsi03PbkWkFqcby7LnJe",
          description: "åç«¯å¼€å‘è§„èŒƒ",
          tags: ["é£ä¹¦", "è§„èŒƒ", "åç«¯"],
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>`
        },



      ]
    },
    {
      title: "Environment",
      links: [

        {
          title: "Jenkins Build Env",
          url: "http://10.9.31.83:9001/job/sz-newcis-dev/",
          description: "Dev åˆ†æ”¯ Jenkins æ„å»º",
          tags: ["Jenkins", "CI", "å†…ç½‘"],
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>`
        },
        {
          title: "Nacos",
          url: "http://10.9.18.74:20009/nacos/#/configurationManagement?dataId=&group=&appName=&namespace=ncis_dev&pageSize=&pageNo=&namespaceShowName=ncis_dev",
          description: "NCIS Nacosåœ¨çº¿",
          tags: ["å†…ç½‘", "é…ç½®", "æœåŠ¡"],
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>`
        },
        {
          title: "å´–å±±æ•°æ®åº“ â€” Cloudç‰ˆ",
          url: "http://10.0.17.94:9328/",
          description: "YaShanäº‘æ•°æ®åº“ç¯å¢ƒ, çº¿ä¸Šç‡•å±±äº‘æ•°æ®åº“",
          tags: ["æ•°æ®åº“", "ç¯å¢ƒ", "å†…ç½‘"],
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path></svg>`
        },
        {
          title: "NCIS æƒé™è®¾è®¡",
          url: "https://fyvnc1t6bo.feishu.cn/docx/CQXzdKaHRoP030xxRY0cS1ERnac",
          description: "Newcis æƒé™å’Œç™»å½•è®¾è®¡æ–‡æ¡£",
          tags: ["é£ä¹¦", "è®¾è®¡", "æƒé™"],
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>`
        },

        {
          title: "NCIS é£ä¹¦é¡¹ç›®æ€»è§ˆ",
          url: "https://fyvnc1t6bo.feishu.cn/drive/folder/Pn06fVKxslHtHBdL4vgcdMsEnuk",
          description: "NCIS é£ä¹¦é¡¹ç›®æ€»è§ˆ",
          tags: ["é£ä¹¦", "æ–‡æ¡£", "NCIS"],
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>`
        },

        {
          title: "CCBæµ‹è¯•ç¯å¢ƒ",
          url: "https://demo.tzuat.szgas.com/",
          description: "å»ºè¡Œç³»ç»Ÿæµ‹è¯•ç¯å¢ƒ, æ—§ç³»ç»Ÿæµ‹è¯•ç¯å¢ƒ",
          tags: ["å¤–éƒ¨", "CCB", "ç¯å¢ƒ"],
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>`
        }
      ]
    }
  ];

  // ===================================================================================
  // ===== ä¸‹é¢çš„ä»£ç æ˜¯ç”¨æ¥æ¸²æŸ“é¡µé¢çš„ï¼Œä¸€èˆ¬ä¸éœ€è¦ä¿®æ”¹ =====
  // ===================================================================================
  document.addEventListener('DOMContentLoaded', function () {
    const categoriesContainer = document.querySelector('.categories');
    const tagsContainer = document.querySelector('[data-tags-container]');
    const activeTagLabel = document.querySelector('[data-active-tag]');
    const domainSummaryEl = document.querySelector('[data-stat="domains"]');
    const heroGreeting = document.querySelector('[data-greeting]');
    const heroTip = document.querySelector('[data-hero-tip]');
    const hotTagsContainer = document.querySelector('[data-hot-tags]');
    const heroPanel = document.querySelector('[data-hero]');
    const miniTip = document.querySelector('[data-mini-tip]');
    const recentList = document.querySelector('[data-recent-list]');
    const clearHistoryBtn = document.querySelector('[data-clear-history]');
    const toastEl = document.querySelector('[data-toast]');

    let toastTimer = null;
    let activeTag = 'all';
    const stats = computeStats(navigationData);
    const expandedCategories = new Map(
      navigationData.map(category => [category.title, true])
    );
    let recentLinks = loadRecentLinks();

    updateDomainSummary(stats);
    renderHero(stats);
    renderMiniTip(stats);
    updateActiveTagLabel();
    renderTags(stats.tagCounts, stats.linkCount);
    renderContent(activeTag);
    renderRecentLinks(recentLinks);

    categoriesContainer.addEventListener('click', function (event) {
      const toggleBtn = event.target.closest('[data-toggle-category]');
      if (toggleBtn) {
        const categoryTitle = toggleBtn.getAttribute('data-toggle-category');
        const current = expandedCategories.get(categoryTitle);
        expandedCategories.set(categoryTitle, !current);
        renderContent(activeTag);
        return;
      }

      const linkItem = event.target.closest('.link-item');
      if (!linkItem) {
        return;
      }

      const url = linkItem.getAttribute('data-url');
      if (!url) {
        return;
      }

      const payload = {
        title: linkItem.getAttribute('data-title') || 'æœªçŸ¥é“¾æ¥',
        url,
        category: linkItem.getAttribute('data-category') || '',
        tags: (linkItem.getAttribute('data-tags') || '')
          .split(',')
          .map(tag => tag.trim())
          .filter(Boolean),
        timestamp: Date.now()
      };

      window.open(url, '_blank');
      saveRecentLink(payload);
      recentLinks = loadRecentLinks();
      renderRecentLinks(recentLinks);
      showToast(`å·²æ‰“å¼€ã€Œ${payload.title}ã€`);
    });

    if (tagsContainer) {
      tagsContainer.addEventListener('click', function (event) {
        const button = event.target.closest('.tag-chip');
        if (!button) {
          return;
        }
        const selectedTag = button.getAttribute('data-tag');
        if (!selectedTag) {
          return;
        }
        activeTag = selectedTag === activeTag ? 'all' : selectedTag;
        updateActiveTagLabel();
        renderTags(stats.tagCounts, stats.linkCount);
        renderContent(activeTag);
      });
    }

    if (hotTagsContainer) {
      hotTagsContainer.addEventListener('click', function (event) {
        const tagBtn = event.target.closest('[data-quick-tag]');
        if (!tagBtn) {
          return;
        }
        const tagValue = tagBtn.getAttribute('data-quick-tag');
        if (!tagValue) {
          return;
        }
        activeTag = tagValue;
        updateActiveTagLabel();
        renderTags(stats.tagCounts, stats.linkCount);
        renderContent(activeTag);
        showToast(`å·²åˆ‡æ¢åˆ°ã€Œ${tagValue}ã€æ ‡ç­¾`);
      });
    }

    if (clearHistoryBtn) {
      clearHistoryBtn.addEventListener('click', function () {
        clearRecentLinks();
        recentLinks = [];
        renderRecentLinks(recentLinks);
        showToast('å·²æ¸…ç©ºæœ€è¿‘è®¿é—®');
      });
    }

    function renderContent(filterTag = 'all') {
      if (!categoriesContainer) {
        return;
      }

      let html = '';
      let visibleCategories = 0;

      navigationData.forEach(category => {
        const matchingLinks = category.links.filter(link => matchesTag(link, filterTag));

        if (!matchingLinks.length) {
          return;
        }

        visibleCategories += 1;
        const isExpanded = expandedCategories.get(category.title) !== false;
        const linksHTML = matchingLinks.map(link => createLinkHTML(link, category.title)).join('');

        html += `
          <div class="category ${isExpanded ? '' : 'collapsed'}">
            <div class="category-header">
              <h2 class="category-title">${escapeHTML(category.title)}</h2>
              <div>
                <span class="category-count">${matchingLinks.length} æ¡</span>
                <button class="category-toggle" data-toggle-category="${escapeHTML(category.title)}">${isExpanded ? 'æ”¶èµ·' : 'å±•å¼€'}</button>
              </div>
            </div>
            <div class="links">
              ${linksHTML}
            </div>
          </div>
        `;
      });

      if (visibleCategories === 0) {
        const keyword = filterTag === 'all' ? 'å…¨éƒ¨' : filterTag;
        categoriesContainer.innerHTML = `<div class="empty-state">æ²¡æœ‰æ‰¾åˆ°ä¸â€œ${escapeHTML(keyword)}â€ç›¸å…³çš„é“¾æ¥ï¼Œæ¢ä¸ªæ ‡ç­¾è¯•è¯•ï¼Ÿ</div>`;
        return;
      }

      categoriesContainer.innerHTML = html;
    }

    function createLinkHTML(link, categoryTitle) {
      const safeTitle = escapeHTML(link.title);
      const rawUrl = link.url || '';
      const safeUrl = escapeHTML(rawUrl);
      const safeDescription = escapeHTML((link.description || '').trim() || 'æš‚æ— æè¿°');
      const tagsMarkup = Array.isArray(link.tags)
        ? link.tags
            .filter(Boolean)
            .map(tag => `<span class="link-tag">${escapeHTML(tag)}</span>`)
            .join('')
        : '';
      const tagsAttr = Array.isArray(link.tags) ? link.tags.join(',') : '';

      return `
        <div class="link-item" data-url="${safeUrl}" data-title="${safeTitle}" data-category="${escapeHTML(categoryTitle)}" data-tags="${escapeHTML(tagsAttr)}">
          <div class="link-icon">${link.icon}</div>
          <div class="link-content">
            <div class="link-title">${safeTitle}</div>
            <div class="link-url">${safeUrl}</div>
            ${tagsMarkup ? `<div class="link-tags">${tagsMarkup}</div>` : ''}
            <div class="tooltip">${safeDescription}</div>
          </div>
        </div>
      `;
    }

    function updateDomainSummary(currentStats) {
      if (!domainSummaryEl) {
        return;
      }
      domainSummaryEl.textContent = `é£ä¹¦ ${currentStats.domainGroups["é£ä¹¦"]} / å†…ç½‘ ${currentStats.domainGroups["å†…ç½‘"]} / å¤–éƒ¨ ${currentStats.domainGroups["å¤–éƒ¨"]}`;
    }

    function renderHero(currentStats) {
      if (heroGreeting) {
        heroGreeting.textContent = getGreeting();
      }
      if (heroTip) {
        heroTip.textContent = getWorkTip(currentStats);
      }
      if (hotTagsContainer) {
        const entries = Array.from(currentStats.tagCounts.entries()).sort((a, b) => b[1] - a[1]);
        const hotList = entries.slice(0, 3);
        hotTagsContainer.innerHTML = hotList.length
          ? hotList
              .map(
                ([tag, count]) =>
                  `<button class="hero-tag" data-quick-tag="${escapeHTML(tag)}">${escapeHTML(tag)} Â· ${count}</button>`
              )
              .join('')
          : '<span class="hero-tag">æš‚æ— æ ‡ç­¾</span>';
      }
      if (heroPanel) {
        heroPanel.setAttribute('aria-live', 'polite');
      }
    }

    function renderMiniTip(currentStats) {
      if (!miniTip) {
        return;
      }
      if (currentStats.domainGroups["é£ä¹¦"] > currentStats.domainGroups["å¤–éƒ¨"]) {
        miniTip.textContent = 'é£ä¹¦æ–‡æ¡£è¾ƒå¤šï¼Œè®°å¾—æå‰ç™»å½•è´¦å·ï¼Œé¿å…ä¸´æ—¶è·³è½¬å—é™ã€‚';
      } else {
        miniTip.textContent = 'å°æç¤ºï¼šåˆç†å®‰æ’ç¢ç‰‡æ—¶é—´ï¼Œå¸¸ç”¨é“¾æ¥å¯ä»¥æ”¶è—ï¼Œä¿¡æ¯æ£€ç´¢æ›´é«˜æ•ˆã€‚';
      }
    }

    function renderTags(tagCounts, totalLinks) {
      if (!tagsContainer) {
        return;
      }

      const entries = Array.from(tagCounts.entries()).sort((a, b) => {
        if (b[1] === a[1]) {
          return a[0].localeCompare(b[0], 'zh-Hans');
        }
        return b[1] - a[1];
      });

      let html = createTagChip('all', 'å…¨éƒ¨', totalLinks, activeTag === 'all');
      entries.forEach(([tag, count]) => {
        html += createTagChip(tag, tag, count, activeTag === tag);
      });

      tagsContainer.innerHTML = html;
    }

    function createTagChip(tagValue, label, count, isActive) {
      return `<button class="tag-chip ${isActive ? 'active' : ''}" data-tag="${escapeHTML(tagValue)}">${escapeHTML(label)} (${count})</button>`;
    }

    function renderRecentLinks(list) {
      if (!recentList) {
        return;
      }
      if (!list.length) {
        recentList.innerHTML = `<div class="recent-empty">è¿˜æ²¡æœ‰è®¿é—®è®°å½•ï¼Œç‚¹å‡»ä»»æ„é“¾æ¥å³å¯è®°å½•ã€‚</div>`;
        return;
      }

      recentList.innerHTML = list
        .map(item => {
          const timeLabel = formatTimestamp(item.timestamp);
          const metaPieces = [item.category, item.tags && item.tags.length ? item.tags.join(' / ') : null]
            .filter(Boolean)
            .join(' Â· ');
          return `
            <div class="recent-item">
              <div class="recent-title">${escapeHTML(item.title)}</div>
              <div class="recent-meta">${escapeHTML(metaPieces || ' ')}</div>
              <div class="recent-meta">${timeLabel}</div>
            </div>
          `;
        })
        .join('');
    }

    function matchesTag(link, filterTag) {
      if (filterTag === 'all') {
        return true;
      }
      if (!Array.isArray(link.tags)) {
        return false;
      }
      return link.tags.includes(filterTag);
    }

    function computeStats(data) {
      const snapshot = {
        categoryCount: data.length,
        linkCount: 0,
        descriptionCount: 0,
        httpsCount: 0,
        httpCount: 0,
        domainGroups: {
          "é£ä¹¦": 0,
          "å†…ç½‘": 0,
          "å¤–éƒ¨": 0
        },
        tagCounts: new Map()
      };

      data.forEach(category => {
        category.links.forEach(link => {
          snapshot.linkCount += 1;

          if (link.description && link.description.trim().length > 0) {
            snapshot.descriptionCount += 1;
          }

          if (/^https:\/\//i.test(link.url)) {
            snapshot.httpsCount += 1;
          } else if (/^http:\/\//i.test(link.url)) {
            snapshot.httpCount += 1;
          }

          const domain = extractDomain(link.url);
          const domainGroup = classifyDomain(domain);
          snapshot.domainGroups[domainGroup] += 1;

          const linkTags = Array.isArray(link.tags) ? link.tags : [];
          linkTags.forEach(tag => {
            const trimmedTag = tag.trim();
            if (!trimmedTag) {
              return;
            }
            snapshot.tagCounts.set(
              trimmedTag,
              (snapshot.tagCounts.get(trimmedTag) || 0) + 1
            );
          });
        });
      });

      return snapshot;
    }

    function extractDomain(url) {
      try {
        return new URL(url).hostname.toLowerCase();
      } catch (error) {
        return '';
      }
    }

    function classifyDomain(hostname) {
      if (!hostname) {
        return "å¤–éƒ¨";
      }
      if (hostname.includes('feishu.cn')) {
        return "é£ä¹¦";
      }
      if (
        hostname.includes('szgas.com') ||
        hostname.includes('ncis') ||
        hostname.startsWith('10.') ||
        hostname.startsWith('192.168.') ||
        /^172\.(1[6-9]|2[0-9]|3[0-1])\./.test(hostname)
      ) {
        return "å†…ç½‘";
      }
      return "å¤–éƒ¨";
    }

    function escapeHTML(value = '') {
      return String(value)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#39;');
    }

    function updateActiveTagLabel() {
      if (!activeTagLabel) {
        return;
      }
      activeTagLabel.textContent =
        activeTag === 'all'
          ? "å¿«é€Ÿæ ‡ç­¾ï¼ˆç‚¹å‡»ç­›é€‰ï¼‰"
          : `å¿«é€Ÿæ ‡ç­¾ Â· å½“å‰ï¼š${activeTag}`;
    }

    function getGreeting() {
      const hour = new Date().getHours();
      if (hour < 6) return 'å¤œæ·±äº†ï¼Œæ³¨æ„ä¼‘æ¯ ğŸŒ™';
      if (hour < 12) return 'æ—©å®‰ï¼Œå¼€å¯é«˜æ•ˆçš„ä¸€å¤© â˜€ï¸';
      if (hour < 18) return 'ä¸‹åˆå¥½ï¼Œä¿æŒç¨³å¥èŠ‚å¥ â˜•';
      return 'æ™šä¸Šå¥½ï¼Œåˆ«å¿˜äº†åŠæ—¶å¤ç›˜ ğŸŒ†';
    }

    function getWorkTip(currentStats) {
      if (currentStats.linkCount > 20) {
        return `å½“å‰å…±æœ‰ ${currentStats.linkCount} ä¸ªé“¾æ¥ï¼Œåˆç†ä½¿ç”¨æ ‡ç­¾èƒ½æ›´å¿«å®šä½ã€‚`;
      }
      return 'è‹¥éœ€è¦è¡¥å……è¯´æ˜ï¼Œå¯åœ¨é“¾æ¥å¯¹è±¡ä¸­æ·»åŠ  description å­—æ®µè®©å›¢é˜Ÿæ›´å¿«ç†è§£ã€‚';
    }

    function formatTimestamp(timestamp) {
      if (!timestamp) {
        return '';
      }
      const date = new Date(Number(timestamp));
      if (Number.isNaN(date.getTime())) {
        return '';
      }
      const month = `${date.getMonth() + 1}`.padStart(2, '0');
      const day = `${date.getDate()}`.padStart(2, '0');
      const hour = `${date.getHours()}`.padStart(2, '0');
      const minute = `${date.getMinutes()}`.padStart(2, '0');
      return `${month}/${day} ${hour}:${minute}`;
    }

    function loadRecentLinks() {
      try {
        const raw = localStorage.getItem(RECENT_LINKS_KEY);
        if (!raw) {
          return [];
        }
        const parsed = JSON.parse(raw);
        if (!Array.isArray(parsed)) {
          return [];
        }
        return parsed.slice(0, MAX_RECENT_LINKS);
      } catch (error) {
        console.warn('æ— æ³•è¯»å–æœ€è¿‘è®¿é—®è®°å½•', error);
        return [];
      }
    }

    function saveRecentLink(link) {
      try {
        const existing = loadRecentLinks().filter(item => item.url !== link.url);
        existing.unshift(link);
        const trimmed = existing.slice(0, MAX_RECENT_LINKS);
        localStorage.setItem(RECENT_LINKS_KEY, JSON.stringify(trimmed));
      } catch (error) {
        console.warn('æ— æ³•å†™å…¥æœ€è¿‘è®¿é—®è®°å½•', error);
      }
    }

    function clearRecentLinks() {
      try {
        localStorage.removeItem(RECENT_LINKS_KEY);
      } catch (error) {
        console.warn('æ— æ³•æ¸…é™¤æœ€è¿‘è®¿é—®è®°å½•', error);
      }
    }

    function showToast(message) {
      if (!toastEl) {
        return;
      }
      toastEl.textContent = message;
      toastEl.classList.add('show');
      if (toastTimer) {
        clearTimeout(toastTimer);
      }
      toastTimer = setTimeout(() => {
        toastEl.classList.remove('show');
      }, 2400);
    }
  });
</script>
</body>

</html>
